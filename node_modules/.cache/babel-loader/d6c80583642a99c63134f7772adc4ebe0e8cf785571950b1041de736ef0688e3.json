{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import axios from\"axios\";import Login from\"./components/Login\";import HomePage from\"./components/HomePage\";import StepOne from\"./components/StepOne\";import StepTwo from\"./components/StepTwo\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const api=\"https://kyc.infyss.com/api\";function App(){const[currentPage,setCurrentPage]=useState(\"login\");const[currentStep,setCurrentStep]=useState(1);const[currentUser,setCurrentUser]=useState(null);const[formData,setFormData]=useState({number:\"\",email:\"\",password:\"\",confirmPassword:\"\",companyName:\"\",name:\"\",organizationName:\"\",gstn:\"\",companyAddress:\"\",companyPincode:\"\",city:\"\",state:\"\"});// ðŸ” Auto-login\nuseEffect(()=>{const token=localStorage.getItem(\"access\");if(!token)return;axios.get(api+\"/auth/me/\",{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>{setCurrentUser(res.data.data);setCurrentPage(\"home\");}).catch(()=>{localStorage.clear();setCurrentPage(\"login\");});},[]);// ðŸ” LOGIN\nconst handleLogin=async(mobile,password)=>{try{const res=await axios.post(api+\"/auth/login/\",{mobile,password});localStorage.setItem(\"access\",res.data.tokens.access);localStorage.setItem(\"refresh\",res.data.tokens.refresh);const profile=await axios.get(api+\"/auth/me/\",{headers:{Authorization:\"Bearer \".concat(res.data.tokens.access)}});setCurrentUser(profile.data.data);setCurrentPage(\"home\");return{success:true};}catch(_unused){return{success:false,error:\"Invalid mobile or password\"};}};const handleRegistrationComplete=async()=>{try{// âœ… Backend payload mapping\nconst payload={mobile:formData.number,email:formData.email,password:formData.password,organisation_name:formData.organizationName,gst_number:formData.gstn,authorised_person_name:formData.name,address:formData.companyAddress,city:formData.city,state:formData.state,pincode:formData.companyPincode,disclaimer_accepted:true};await axios.post(api+\"/auth/register/\",payload);alert(\"Registration successful. Please login.\");setCurrentPage(\"login\");setCurrentStep(1);}catch(err){var _err$response,_err$response2;console.error((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data);alert(JSON.stringify(((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.data)||\"Registration failed\"));}};// ðŸšª LOGOUT\nconst handleLogout=()=>{localStorage.clear();setCurrentUser(null);setCurrentPage(\"login\");};return/*#__PURE__*/_jsxs(_Fragment,{children:[currentPage===\"login\"&&/*#__PURE__*/_jsx(Login,{onLogin:handleLogin,onNavigateToRegister:()=>{setCurrentPage(\"register\");setCurrentStep(1);}}),currentPage===\"home\"&&/*#__PURE__*/_jsx(HomePage,{user:currentUser,onLogout:handleLogout}),currentPage===\"register\"&&currentStep===1&&/*#__PURE__*/_jsx(StepOne,{formData:formData,setFormData:setFormData,onNext:()=>setCurrentStep(2)}),currentPage===\"register\"&&currentStep===2&&/*#__PURE__*/_jsx(StepTwo,{formData:formData,setFormData:setFormData,onNext:handleRegistrationComplete,onPrevious:()=>setCurrentStep(1)})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","axios","Login","HomePage","StepOne","StepTwo","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","api","App","currentPage","setCurrentPage","currentStep","setCurrentStep","currentUser","setCurrentUser","formData","setFormData","number","email","password","confirmPassword","companyName","name","organizationName","gstn","companyAddress","companyPincode","city","state","token","localStorage","getItem","get","headers","Authorization","concat","then","res","data","catch","clear","handleLogin","mobile","post","setItem","tokens","access","refresh","profile","success","_unused","error","handleRegistrationComplete","payload","organisation_name","gst_number","authorised_person_name","address","pincode","disclaimer_accepted","alert","err","_err$response","_err$response2","console","response","JSON","stringify","handleLogout","children","onLogin","onNavigateToRegister","user","onLogout","onNext","onPrevious"],"sources":["C:/Users/karth/OneDrive/Desktop/react simple/one/org-1/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nimport Login from \"./components/Login\";\r\nimport HomePage from \"./components/HomePage\";\r\nimport StepOne from \"./components/StepOne\";\r\nimport StepTwo from \"./components/StepTwo\";\r\n\r\nconst api = \"https://kyc.infyss.com/api\";\r\n\r\nfunction App() {\r\n  const [currentPage, setCurrentPage] = useState(\"login\");\r\n  const [currentStep, setCurrentStep] = useState(1);\r\n  const [currentUser, setCurrentUser] = useState(null);\r\n\r\n  const [formData, setFormData] = useState({\r\n    number: \"\",\r\n    email: \"\",\r\n    password: \"\",\r\n    confirmPassword: \"\",\r\n    companyName: \"\",\r\n    name: \"\",\r\n    organizationName: \"\",\r\n    gstn: \"\",\r\n    companyAddress: \"\",\r\n    companyPincode: \"\",\r\n    city: \"\",\r\n    state: \"\"\r\n  });\r\n\r\n  // ðŸ” Auto-login\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"access\");\r\n    if (!token) return;\r\n\r\n    axios.get(api + \"/auth/me/\", {\r\n      headers: { Authorization: `Bearer ${token}` }\r\n    })\r\n    .then(res => {\r\n      setCurrentUser(res.data.data);\r\n      setCurrentPage(\"home\");\r\n    })\r\n    .catch(() => {\r\n      localStorage.clear();\r\n      setCurrentPage(\"login\");\r\n    });\r\n  }, []);\r\n\r\n  // ðŸ” LOGIN\r\n  const handleLogin = async (mobile, password) => {\r\n    try {\r\n      const res = await axios.post(api + \"/auth/login/\", { mobile, password });\r\n\r\n      localStorage.setItem(\"access\", res.data.tokens.access);\r\n      localStorage.setItem(\"refresh\", res.data.tokens.refresh);\r\n\r\n      const profile = await axios.get(api + \"/auth/me/\", {\r\n        headers: { Authorization: `Bearer ${res.data.tokens.access}` }\r\n      });\r\n\r\n      setCurrentUser(profile.data.data);\r\n      setCurrentPage(\"home\");\r\n\r\n      return { success: true };\r\n    } catch {\r\n      return { success: false, error: \"Invalid mobile or password\" };\r\n    }\r\n  };\r\n   const handleRegistrationComplete = async () => {\r\n    try {\r\n      // âœ… Backend payload mapping\r\n      const payload = {\r\n        mobile: formData.number,\r\n        email: formData.email,\r\n        password: formData.password,\r\n\r\n        organisation_name: formData.organizationName,\r\n        gst_number: formData.gstn,\r\n        authorised_person_name: formData.name,\r\n\r\n        address: formData.companyAddress,\r\n        city: formData.city,\r\n        state: formData.state,\r\n        pincode: formData.companyPincode,\r\n\r\n        disclaimer_accepted: true\r\n      };\r\n\r\n      await axios.post(\r\n        api+\"/auth/register/\",\r\n        payload\r\n      );\r\n\r\n      alert(\"Registration successful. Please login.\");\r\n      setCurrentPage(\"login\");\r\n      setCurrentStep(1);\r\n\r\n    } catch (err) {\r\n      console.error(err.response?.data);\r\n      alert(JSON.stringify(err.response?.data || \"Registration failed\"));\r\n    }\r\n  };\r\n\r\n\r\n  // ðŸšª LOGOUT\r\n  const handleLogout = () => {\r\n    localStorage.clear();\r\n    setCurrentUser(null);\r\n    setCurrentPage(\"login\");\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {currentPage === \"login\" && (\r\n        <Login onLogin={handleLogin} onNavigateToRegister={() => {\r\n          setCurrentPage(\"register\");\r\n          setCurrentStep(1);\r\n        }} />\r\n      )}\r\n\r\n      {currentPage === \"home\" && (\r\n        <HomePage user={currentUser} onLogout={handleLogout} />\r\n      )}\r\n\r\n      {currentPage === \"register\" && currentStep === 1 && (\r\n        <StepOne formData={formData} setFormData={setFormData} onNext={() => setCurrentStep(2)} />\r\n      )}\r\n\r\n      {currentPage === \"register\" && currentStep === 2 && (\r\n        <StepTwo formData={formData} setFormData={setFormData}\r\n          onNext={handleRegistrationComplete}\r\n          onPrevious={() => setCurrentStep(1)}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}